<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="Function modifiers" href="../function-modifiers/" /><link rel="prev" title="Visualization" href="../visualization/" />
        <link rel="canonical" href="https://hamilton.dagworks.io/concepts/materialization/" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06.dev1 -->
        <title>Materialization - Hamilton</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=3912a5f9" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/testimonials.css?v=bd684830" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     ðŸ“¢ Announcing the <a target="_blank" href="https://www.meetup.com/global-hamilton-open-source-user-group-meetup/">Hamilton Meetup Group</a>. Sign up to attend events! ðŸ“¢ 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">Hamilton</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  
  <span class="sidebar-brand-text">Hamilton</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">USER GUIDE</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../get-started/">Get Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Get Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/why-hamilton/">Why use Apache Hamilton?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/install/">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/your-first-dataflow/">Your First Dataflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/learning-resources/">Learning Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/contributing/">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/license/">License</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Concepts</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../glossary/">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../node/">Functions, nodes &amp; dataflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../driver/">Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/">Visualization</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Materialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../function-modifiers/">Function modifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../builder/">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../function-modifiers-advanced/">Function modifiers (Advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel-task/">Dynamic DAGs/Parallel Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/">UI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/#local-mode">Local Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/#docker-deployed-mode">Docker/Deployed Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/#get-started">Get started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ui/#sdk-configuration">SDK Configuration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../best-practices/">Best Practices</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Best Practices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/function-naming/">Function Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/migrating-to-hamilton/">Migrating to Apache Hamilton</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/code-organization/">Code Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/common-indices/">Common Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/output-immutability/">Output Immutability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/using-within-your-etl-system/">Using within your ETL System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/loading-data/">Loading Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../how-tos/">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-in-jupyter-notebook/">Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/load-data/">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/caching-tutorial/">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-for-feature-engineering/">Feature engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/ml-training/">Model training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/llm-workflows/">LLM workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/run-data-quality-checks/">Data quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-hamilton-for-lineage/">Lineage + Apache Hamilton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/scale-up/">Scaling computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/microservice/">Microservice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/extensions-autoloading/">Extension autoloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/wrapping-driver/">Wrapping the Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/cli-reference/">Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/pre-commit-hooks/">pre-commit hooks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hamilton-ui/">Apache Hamilton UI</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Apache Hamilton UI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/">UI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#local-mode">Local Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#docker-deployed-mode">Docker/Deployed Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#get-started">Get started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#sdk-configuration">SDK Configuration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hamilton-vscode/">IDE extension</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of IDE extension</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-vscode/vscode_extension/">Apache Hamilton VSCode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-vscode/language_server/">Language Server</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../integrations/">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Integrations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/dlt/">dlt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/fastapi/">FastAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/ibis/">Ibis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/streamlit/">Streamlit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/dbt/">dbt</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/mlflow">MLFlow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/airflow">Airflow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/aws">Amazon Web Services</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/LLM_Workflows/image_telephone">Burr</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/dagster">Dagster</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/dask">Dask</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/feast">Feast</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/outerbounds/hamilton-metaflow">Metaflow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/data_quality/pandera">Pandera</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/plotly">Plotly</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/polars">Polars</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/prefect">Prefect</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/ray">Ray</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/slack">Slack</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/spark">Spark</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/vaex">Vaex</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/narwhals">Narwhals</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/openlineage">OpenLineage</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../code-comparisons/">Code Comparisons</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Code Comparisons</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/kedro/">Kedro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/dagster/">Dagster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/langchain/">LangChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/airflow/">Airflow</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community/">Meet-ups</a></li>
<li class="toctree-l1"><a class="reference external" href="https://join.slack.com/t/hamilton-opensource/shared_invite/zt-2niepkra8-DGKGf_tTYhXuJWBTXtIs4g">Slack</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">REFERENCE</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/decorators/">Decorators</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Decorators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/check_output/">check_output*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/config_when/">config.when*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/dataloader/">dataloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/datasaver/">datasaver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/does/">does</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/extract_columns/">extract_columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/extract_fields/">extract_fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/inject/">inject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/load_from/">load_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize/">parameterize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_extract_columns/">parameterize_extract_columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_frame/">parameterize_frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_sources/">parameterize_sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_subdag/">parameterized_subdag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_values/">parameterize_values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/pipe/">pipe family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/resolve/">resolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/save_to/">save_to</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/subdag/">subdag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/schema/">schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/tag/">tag*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/with_columns/">with_columns</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/drivers/">Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#driver">Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#defaultgraphexecutor">DefaultGraphExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#taskbasedgraphexecutor">TaskBasedGraphExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/AsyncDriver/">AsyncDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Custom/">Custom Driver</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/caching/">Caching</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Caching</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/caching-logic/">Caching logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/data-versioning/">Data versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/stores/">Stores</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/graph-adapters/">GraphAdapters</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of GraphAdapters</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SimplePythonDataFrameGraphAdapter/">SimplePythonDataFrameGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SimplePythonGraphAdapter/">SimplePythonGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/HamiltonGraphAdapter/">HamiltonGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/AsyncGraphAdapter/">h_async.AsyncGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/ThreadPoolFutureAdapter/">h_threadpool.FutureAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/CachingGraphAdapter/">CachingGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/DaskGraphAdapter/">h_dask.DaskGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/PySparkUDFGraphAdapter/">h_spark.PySparkUDFGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/RayGraphAdapter/">h_ray.RayGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/RayWorkflowGraphAdapter/">h_ray.RayWorkflowGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SparkKoalasGraphAdapter/">h_spark.SparkKoalasGraphAdapter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/lifecycle-hooks/">Lifecycle Adapters</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Lifecycle Adapters</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/ResultBuilder/">lifecycle.ResultBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/LegacyResultMixin/">lifecycle.LegacyResultMixin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphAdapter/">lifecycle.api.GraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NodeExecutionHook/">lifecycle.NodeExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphExecutionHook/">lifecycle.api.GraphExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/EdgeConnectionHook/">lifecycle.api.EdgeConnectionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NodeExecutionMethod/">lifecycle.api.NodeExecutionMethod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/StaticValidator/">lifecycle.api.StaticValidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphConstructionHook/">lifecycle.api.GraphConstructionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskSubmissionHook/">lifecycle.api.TaskSubmissionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskReturnHook/">lifecycle.api.TaskReturnHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskExecutionHook/">lifecycle.api.TaskExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskGroupingHook/">lifecycle.api.TaskGroupingHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/PDBDebugger/">lifecycle.PDBDebugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/PrintLn/">lifecycle.PrintLn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/ProgressBar/">plugins.h_tqdm.ProgressBar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/RichProgressBar/">plugins.h_rich.RichProgressBar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/DDOGTracer/">plugins.h_ddog.DDOGTracer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/FunctionInputOutputTypeChecker/">lifecycle.FunctionInputOutputTypeChecker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/SlackNotifierHook/">plugins.h_slack.SlackNotifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GracefulErrorAdapter/">lifecycle.GracefulErrorAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/SparkInputValidator/">plugins.h_spark.SparkInputValidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/Narwhals/">plugins.h_narhwals.NarwhalsAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/Narwhals/#plugins-h-narhwals-narwhalsdataframeresultbuilder">plugins.h_narhwals.NarwhalsDataFrameResultBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/MLFlowTracker/">plugins.h_mlflow.MLFlowTracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NoEdgeAndInputTypeChecking/">lifecycle.NoEdgeAndInputTypeChecking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/OpenLineageAdapter/">plugins.h_openlineage.OpenLineageAdapter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/result-builders/">ResultBuilders</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of ResultBuilders</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Generic/">Generic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Numpy/">Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Pandas/">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Polars/">Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Dask/">Dask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Custom/">Custom ResultBuilder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/io/">I/O</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of I/O</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/">Using Data Adapters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/#data-loaders">Data Loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/#data-savers">Data Savers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/adapter-documentation/">Data Adapters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/dataflows/">Dataflows</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Dataflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/clear_storage/">clear_storage()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/copy/">copy()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/find/">find()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/import_module/">import_module()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/inspect/">inspect()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/inspect_module/">inspect_module()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/install_dependencies_string/">install_dependencies_string()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/latest_commit/">latest_commit()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/list/">list()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/pull_module/">pull_module()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/disabling-telemetry/">Telemetry</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXTERNAL RESOURCES</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/hamilton">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.tryhamilton.dev/">tryhamilton.dev</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hub.dagworks.io/docs/">Dataflow Hub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blog.dagworks.io/">Blog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/apache/hamilton/blob/main/docs/concepts/materialization.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/apache/hamilton/edit/main/docs/concepts/materialization.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="materialization">
<h1>Materialization<a class="headerlink" href="#materialization" title="Link to this heading">Â¶</a></h1>
<p>So far, we executed our dataflow using the <code class="docutils literal notranslate"><span class="pre">Driver.execute()</span></code> method, which can receive an <code class="docutils literal notranslate"><span class="pre">inputs</span></code> dictionary and return a <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary (by default). However, you can also execute code with <code class="docutils literal notranslate"><span class="pre">Driver.materialize()</span></code> to directly read from / write to external data sources (file, database, cloud data store).</p>
<p>On this page, youâ€™ll learn:</p>
<ul class="simple">
<li><p>How to load and save data in Apache Hamilton</p></li>
<li><p>Why use materialization</p></li>
<li><p>What are <code class="docutils literal notranslate"><span class="pre">DataSaver</span></code> and <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> objects</p></li>
<li><p>The difference between <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> and <code class="docutils literal notranslate"><span class="pre">.materialize()</span></code></p></li>
<li><p>The basics to write your own materializer</p></li>
</ul>
<section id="different-ways-to-write-the-same-dataflow">
<h2>Different ways to write the same dataflow<a class="headerlink" href="#different-ways-to-write-the-same-dataflow" title="Link to this heading">Â¶</a></h2>
<p>Below are 6 ways to write a dataflow that:</p>
<ol class="arabic simple">
<li><p>loads a dataframe from a parquet file</p></li>
<li><p>preprocesses the dataframe</p></li>
<li><p>trains a machine learning model</p></li>
<li><p>saves the trained model</p></li>
</ol>
<p>The first two options donâ€™t use the concept of materialization and the next four do.</p>
</section>
<section id="without-materialization">
<h2>Without materialization<a class="headerlink" href="#without-materialization" title="Link to this heading">Â¶</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><ol class="arabic simple">
<li><p>From nodes</p></li>
</ol>
</th>
<th class="head"><ol class="arabic simple" start="2">
<li><p>From <code class="docutils literal notranslate"><span class="pre">Driver</span></code></p></li>
</ol>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>


<span class="k">def</span><span class="w"> </span><span class="nf">raw_df</span><span class="p">(</span><span class="n">data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load raw data from parquet file&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save trained model to JSON format&quot;&quot;&quot;</span>
    <span class="n">model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>

    <span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">)</span>
    <span class="n">final_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;save_model&quot;</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">final_vars</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">)</span>
    <span class="c1"># results[&quot;save_model&quot;] == None</span>
</pre></div>
</div>
</td>
<td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>


<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>

    <span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">raw_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">data_path</span><span class="p">))</span>
    <span class="n">final_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">final_vars</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../../_images/node_ctx.png"><img alt="../../_images/node_ctx.png" src="../../_images/node_ctx.png" style="width: 500px;" />
</a>
</td>
<td><a class="reference internal image-reference" href="../../_images/driver_ctx.png"><img alt="../../_images/driver_ctx.png" src="../../_images/driver_ctx.png" style="width: 500px;" />
</a>
</td>
</tr>
</tbody>
</table>
</div>
<p>Observations:</p>
<ol class="arabic simple">
<li><p>These two approaches load and save data using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">xgboost</span></code> without any Apache Hamilton constructs. These methods are transparent and simple to get started, but as the number of node grows (or across projects) defining one node per parquet file to load introduces a lot of boilerplate.</p></li>
<li><p>Using <strong>1) from nodes</strong> improves visibility by including loading &amp; saving  in the dataflow (as illustrated).</p></li>
<li><p>Using <strong>2) from ``Driver``</strong> facilitates modifying loading &amp; saving before code execution when executing the code, without modifying the dataflow itself. It is particularly useful when moving from development to production.</p></li>
</ol>
<section id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">Â¶</a></h3>
<p>Apache Hamiltonâ€™s approach to â€œmaterializationsâ€ aims to solve 3 limitations:</p>
<ol class="arabic simple">
<li><p><strong>Redundancy</strong>: deduplicate loading &amp; saving code to improve maintainability and debugging</p></li>
<li><p><strong>Observability</strong>: include loading &amp; saving in the dataflow for full observability and allow hooks</p></li>
<li><p><strong>Flexibility</strong>: change the loading &amp; saving behavior without editing the dataflow</p></li>
</ol>
</section>
</section>
<section id="with-materialization">
<h2>With materialization<a class="headerlink" href="#with-materialization" title="Link to this heading">Â¶</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><ol class="arabic simple" start="3">
<li><p>Simple Materialization</p></li>
</ol>
</th>
<th class="head"><ol class="arabic simple" start="4">
<li><p>Static materializers</p></li>
</ol>
</th>
<th class="head"><ol class="arabic simple" start="5">
<li><p>Dynamic materializers</p></li>
</ol>
</th>
<th class="head"><ol class="arabic simple" start="6">
<li><p>Function modifiers</p></li>
</ol>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.function_modifiers</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">datasaver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>


<span class="nd">@dataloader</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">raw_df</span><span class="p">(</span><span class="n">data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load raw data from parquet file&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file_and_dataframe_metadata</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@datasaver</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save trained model to JSON format&quot;&quot;&quot;</span>
    <span class="n">model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file_metadata</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>

    <span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">)</span>
    <span class="n">final_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;save_model&quot;</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">final_vars</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">)</span>
    <span class="c1"># results[&quot;save_model&quot;] == None</span>
</pre></div>
</div>
</td>
<td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>


<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.materialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_</span><span class="p">,</span> <span class="n">to</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">materializers</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">from_</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;raw_df&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">data_path</span><span class="p">),</span>
        <span class="n">to</span><span class="o">.</span><span class="n">json</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;model__json&quot;</span><span class="p">,</span>  <span class="c1"># name of the DataSaver node</span>
            <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">],</span>
            <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span>
        <span class="o">.</span><span class="n">with_materializers</span><span class="p">(</span><span class="o">*</span><span class="n">materializers</span><span class="p">)</span>
        <span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;model__json&quot;</span><span class="p">])</span>
    <span class="c1"># results[&quot;model&quot;]  &lt;- the model</span>
    <span class="c1"># results[&quot;model__json&quot;] &lt;- metadata from saving the model</span>
</pre></div>
</div>
</td>
<td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>


<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.materialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_</span><span class="p">,</span> <span class="n">to</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">materializers</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">from_</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;raw_df&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">data_path</span><span class="p">),</span>
        <span class="n">to</span><span class="o">.</span><span class="n">json</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;model__json&quot;</span><span class="p">,</span>  <span class="c1"># name of the DataSaver node</span>
            <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">],</span>
            <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">/model.json&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="c1"># executes all `to.` materializers; use `additional_vars` to execute other nodes</span>
    <span class="n">metadata</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">materialize</span><span class="p">(</span><span class="o">*</span><span class="n">materializers</span><span class="p">,</span> <span class="n">additional_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">])</span>
    <span class="c1"># results[&quot;model&quot;]  &lt;- the model</span>
    <span class="c1"># metadata[&quot;model__json&quot;] &lt;- metadata from saving the model</span>
</pre></div>
</div>
</td>
<td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.function_modifiers</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_from</span><span class="p">,</span> <span class="n">save_to</span><span class="p">,</span> <span class="n">source</span>


<span class="c1"># source(&quot;data_path&quot;) allows to read the input value for `data_path`</span>
<span class="nd">@load_from</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">source</span><span class="p">(</span><span class="s2">&quot;data_path&quot;</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preprocessed_df</span><span class="p">(</span><span class="n">raw_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;preprocess raw data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@save_to</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">source</span><span class="p">(</span><span class="s2">&quot;model_path&quot;</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train model on preprocessed data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">__main__</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>

    <span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">__main__</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">model_path</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">model_path</span><span class="o">=</span><span class="n">model_path</span><span class="p">)</span>
    <span class="n">final_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;save.model&quot;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">final_vars</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">)</span>
    <span class="c1"># results[&quot;model&quot;]  &lt;- the model</span>
    <span class="c1"># results[&quot;save.model&quot;] &lt;- metadata from saving the model</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../../_images/simple_materializer_ctx.png"><img alt="../../_images/simple_materializer_ctx.png" src="../../_images/simple_materializer_ctx.png" style="width: 500px;" />
</a>
</td>
<td><a class="reference internal image-reference" href="../../_images/static_materializer_ctx.png"><img alt="../../_images/static_materializer_ctx.png" src="../../_images/static_materializer_ctx.png" style="width: 500px;" />
</a>
</td>
<td><a class="reference internal image-reference" href="../../_images/dynamic_materializer_ctx.png"><img alt="../../_images/dynamic_materializer_ctx.png" src="../../_images/dynamic_materializer_ctx.png" style="width: 500px;" />
</a>
</td>
<td><a class="reference internal image-reference" href="../../_images/decorator_ctx.png"><img alt="../../_images/decorator_ctx.png" src="../../_images/decorator_ctx.png" style="width: 500px;" />
</a>
</td>
</tr>
</tbody>
</table>
</div>
<section id="simple-materialization">
<h3>Simple Materialization<a class="headerlink" href="#simple-materialization" title="Link to this heading">Â¶</a></h3>
<p>When you donâ€™t need to hide the implementation details of how you read and write, but you
want to track what was read and written, you need to expose extra metadata. This is where
the <a class="reference internal" href="../../reference/decorators/datasaver/"><span class="doc">&#64;datasaver()</span></a> and <a class="reference internal" href="../../reference/decorators/dataloader/"><span class="doc">&#64;dataloader()</span></a> decorators come in. They allow you to return
metadata about what was read and written, and this metadata is then used to track what
was read and written.</p>
<p>This is our recommended first step when youâ€™re starting to use materialization in Apache Hamilton.</p>
</section>
<section id="static-materializers">
<h3>Static materializers<a class="headerlink" href="#static-materializers" title="Link to this heading">Â¶</a></h3>
<p>Passing <code class="docutils literal notranslate"><span class="pre">from_</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code> Apache Hamilton objects to <code class="docutils literal notranslate"><span class="pre">Builder().with_materializers()</span></code> injects into the dataflow standardized nodes to load and save data. It solves the 3 limitations highlighted in the previous section:</p>
<ol class="arabic simple">
<li><p>Redundancy âœ…: Using the <code class="docutils literal notranslate"><span class="pre">from_</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code> Apache Hamilton constructs reduces the boilerplate to load and save data from common formats (JSON, parquet, CSV, etc.) and to interact with 3rd party libraries (pandas, matplotlib, xgboost, dlt, etc.)</p></li>
<li><p>Observability âœ…: Loaders and savers are part of the dataflow. You can view them with <code class="docutils literal notranslate"><span class="pre">Driver.display_all_functions()</span></code> and execute nodes by requesting them with <code class="docutils literal notranslate"><span class="pre">Driver.execute()</span></code>.</p></li>
<li><p>Flexibility âœ…: The loading and saving behavior is decoupled from the dataflow and can modified easily when creating the <code class="docutils literal notranslate"><span class="pre">Driver</span></code> and executing code.</p></li>
</ol>
</section>
<section id="dynamic-materializers">
<h3>Dynamic materializers<a class="headerlink" href="#dynamic-materializers" title="Link to this heading">Â¶</a></h3>
<p>The dataflow is executed by passing <code class="docutils literal notranslate"><span class="pre">from_</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code> objects to <code class="docutils literal notranslate"><span class="pre">Driver.materialize()</span></code> instead of the regular <code class="docutils literal notranslate"><span class="pre">Driver.execute()</span></code>. This approach ressembles <strong>2) from Driver</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">Driver.materialize()</span></code> can receive data savers (<code class="docutils literal notranslate"><span class="pre">from_</span></code>) and loaders (<code class="docutils literal notranslate"><span class="pre">to</span></code>) and will execute all <code class="docutils literal notranslate"><span class="pre">to</span></code> passed. Like <code class="docutils literal notranslate"><span class="pre">Driver.execute()</span></code>, it can receive <code class="docutils literal notranslate"><span class="pre">inputs</span></code>, and <code class="docutils literal notranslate"><span class="pre">overrides</span></code>, but instead of <code class="docutils literal notranslate"><span class="pre">final_vars</span></code> it receives <code class="docutils literal notranslate"><span class="pre">additional_vars</span></code>.</p>
</div>
<ol class="arabic simple">
<li><p>Redundancy âœ…: Uses <code class="docutils literal notranslate"><span class="pre">from_</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code> Apache Hamilton constructs.</p></li>
<li><p>Observability ðŸš¸: Materializers are visible with <code class="docutils literal notranslate"><span class="pre">Driver.visualize_materialization()</span></code>, but canâ€™t be introspected otherwise. Also, you need to rely on <code class="docutils literal notranslate"><span class="pre">Driver.materialize()</span></code> which has a different call signature.</p></li>
<li><p>Flexibility âœ…: Loading and saving is decoupled from the dataflow.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using static materializers is typically preferrable. Static and dynamic materializers can be used together with <code class="docutils literal notranslate"><span class="pre">dr</span> <span class="pre">=</span> <span class="pre">Builder.with_materializers().build()</span></code> and later <code class="docutils literal notranslate"><span class="pre">dr.materialize()</span></code>.</p>
</div>
</section>
<section id="function-modifiers">
<h3>Function modifiers<a class="headerlink" href="#function-modifiers" title="Link to this heading">Â¶</a></h3>
<p>By adding <code class="docutils literal notranslate"><span class="pre">&#64;load_from</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;save_to</span></code> function modifiers (<a class="reference internal" href="../function-modifiers/#loader-saver-decorators"><span class="std std-ref">Load and save external data</span></a>) to Apache Hamilton functions, materializers are generated when using <code class="docutils literal notranslate"><span class="pre">Builder.with_modules()</span></code>. This approach ressembles <strong>1) from Driver</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Under the hood, the <code class="docutils literal notranslate"><span class="pre">&#64;load_from</span></code> modifier uses the same code as <code class="docutils literal notranslate"><span class="pre">from_</span></code> to load data, same for <code class="docutils literal notranslate"><span class="pre">&#64;save_to</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code>.</p>
</div>
<ol class="arabic simple">
<li><p>Redundancy ðŸš¸: Using <code class="docutils literal notranslate"><span class="pre">&#64;load_from</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;save_to</span></code> reduces redundancy. However, to make available to multiple nodes a loaded table, you would need to decorate each node with the same <code class="docutils literal notranslate"><span class="pre">&#64;save_to</span></code>. Also, it might be impractical to decorate dynamically generated nodes (e.g., when using the <code class="docutils literal notranslate"><span class="pre">&#64;parameterize</span></code> function modifier).</p></li>
<li><p>Observability âœ…: Loaders and savers are part of the dataflow.</p></li>
<li><p>Flexibility ðŸš¸: You can modify the path and materializer kwargs at runtime using <code class="docutils literal notranslate"><span class="pre">source()</span></code> in the decorator definition, but you canâ€™t change the format itself (e.g., from parquet to CSV).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It can be desirable to couple loading and saving to the dataflow using function modifiers. It makes it clear when reading the dataflow definition which nodes should load or save data using external sources.</p>
</div>
</section>
</section>
<section id="dataloader-and-datasaver">
<h2>DataLoader and DataSaver<a class="headerlink" href="#dataloader-and-datasaver" title="Link to this heading">Â¶</a></h2>
<p>In Apache Hamilton, <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> and <code class="docutils literal notranslate"><span class="pre">DataSaver</span></code> are classes that define how to load or save a particular data format. Calling <code class="docutils literal notranslate"><span class="pre">Driver.materialize(DataLoader(),</span> <span class="pre">DataSaver())</span></code> adds nodes to the dataflow (see visualizations above).</p>
<p>Here are simplified snippets for saving and loading an XGBoost model to/from JSON.</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>DataLoader</p></th>
<th class="head"><p>DataSaver</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dataclasses</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathLike</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.data_adapters</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>


<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XGBoostJsonReader</span><span class="p">(</span><span class="n">DataLoader</span><span class="p">):</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">,</span> <span class="n">PathLike</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">applicable_types</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">[</span><span class="n">Type</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="c1"># uses the XGBoost library</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">type_</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">metadata</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;json&quot;</span>  <span class="c1"># the name for `from_.{name}`</span>
</pre></div>
</div>
</td>
<td><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dataclasses</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathLike</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.data_adapters</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataSaver</span>


<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XGBoostJsonWriter</span><span class="p">(</span><span class="n">DataSaver</span><span class="p">):</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PathLike</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">applicable_types</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">[</span><span class="n">Type</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># uses the XGBoost library</span>
        <span class="n">data</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;json&quot;</span>  <span class="c1"># the name for `to.{name}`</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>To define your own DataSaver and DataLoader, the Apache Hamilton <a class="reference external" href="https://github.com/apache/hamilton/blob/main/hamilton/plugins/xgboost_extensions.py">XGBoost extension</a> provides a good example</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../function-modifiers/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Function modifiers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../visualization/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Visualization</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Materialization</a><ul>
<li><a class="reference internal" href="#different-ways-to-write-the-same-dataflow">Different ways to write the same dataflow</a></li>
<li><a class="reference internal" href="#without-materialization">Without materialization</a><ul>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#with-materialization">With materialization</a><ul>
<li><a class="reference internal" href="#simple-materialization">Simple Materialization</a></li>
<li><a class="reference internal" href="#static-materializers">Static materializers</a></li>
<li><a class="reference internal" href="#dynamic-materializers">Dynamic materializers</a></li>
<li><a class="reference internal" href="#function-modifiers">Function modifiers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataloader-and-datasaver">DataLoader and DataSaver</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=22e4c79f"></script>
    </body>
</html>