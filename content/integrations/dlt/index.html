<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="FastAPI" href="../fastapi/" /><link rel="prev" title="Integrations" href="../" />
        <link rel="canonical" href="https://hamilton.dagworks.io/integrations/dlt/" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06.dev1 -->
        <title>dlt - Hamilton</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=3912a5f9" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/testimonials.css?v=bd684830" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     📢 Announcing the <a target="_blank" href="https://www.meetup.com/global-hamilton-open-source-user-group-meetup/">Hamilton Meetup Group</a>. Sign up to attend events! 📢 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">Hamilton</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  
  <span class="sidebar-brand-text">Hamilton</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">USER GUIDE</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../get-started/">Get Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Get Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/why-hamilton/">Why use Apache Hamilton?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/install/">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/your-first-dataflow/">Your First Dataflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/learning-resources/">Learning Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/contributing/">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get-started/license/">License</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/">Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/glossary/">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/node/">Functions, nodes &amp; dataflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/driver/">Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/visualization/">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/materialization/">Materialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/function-modifiers/">Function modifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/builder/">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/caching/">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/function-modifiers-advanced/">Function modifiers (Advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/parallel-task/">Dynamic DAGs/Parallel Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/">UI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/#local-mode">Local Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/#docker-deployed-mode">Docker/Deployed Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/#get-started">Get started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ui/#sdk-configuration">SDK Configuration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../concepts/best-practices/">Best Practices</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Best Practices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/function-naming/">Function Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/migrating-to-hamilton/">Migrating to Apache Hamilton</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/code-organization/">Code Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/common-indices/">Common Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/output-immutability/">Output Immutability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/using-within-your-etl-system/">Using within your ETL System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/best-practices/loading-data/">Loading Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../how-tos/">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-in-jupyter-notebook/">Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/load-data/">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/caching-tutorial/">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-for-feature-engineering/">Feature engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/ml-training/">Model training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/llm-workflows/">LLM workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/run-data-quality-checks/">Data quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/use-hamilton-for-lineage/">Lineage + Apache Hamilton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/scale-up/">Scaling computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/microservice/">Microservice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/extensions-autoloading/">Extension autoloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/wrapping-driver/">Wrapping the Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/cli-reference/">Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how-tos/pre-commit-hooks/">pre-commit hooks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hamilton-ui/">Apache Hamilton UI</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Apache Hamilton UI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/">UI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#local-mode">Local Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#docker-deployed-mode">Docker/Deployed Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#get-started">Get started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-ui/ui/#sdk-configuration">SDK Configuration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hamilton-vscode/">IDE extension</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of IDE extension</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-vscode/vscode_extension/">Apache Hamilton VSCode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamilton-vscode/language_server/">Language Server</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Integrations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Integrations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">dlt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fastapi/">FastAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ibis/">Ibis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamlit/">Streamlit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbt/">dbt</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/mlflow">MLFlow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/airflow">Airflow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/aws">Amazon Web Services</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/LLM_Workflows/image_telephone">Burr</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/dagster">Dagster</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/dask">Dask</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/feast">Feast</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/outerbounds/hamilton-metaflow">Metaflow</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/data_quality/pandera">Pandera</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/plotly">Plotly</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/polars">Polars</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/prefect">Prefect</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/ray">Ray</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/slack">Slack</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/spark">Spark</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/vaex">Vaex</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/narwhals">Narwhals</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/openlineage">OpenLineage</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../code-comparisons/">Code Comparisons</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Code Comparisons</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/kedro/">Kedro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/dagster/">Dagster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/langchain/">LangChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code-comparisons/airflow/">Airflow</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community/">Meet-ups</a></li>
<li class="toctree-l1"><a class="reference external" href="https://join.slack.com/t/hamilton-opensource/shared_invite/zt-2niepkra8-DGKGf_tTYhXuJWBTXtIs4g">Slack</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">REFERENCE</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/decorators/">Decorators</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Decorators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/check_output/">check_output*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/config_when/">config.when*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/dataloader/">dataloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/datasaver/">datasaver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/does/">does</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/extract_columns/">extract_columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/extract_fields/">extract_fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/inject/">inject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/load_from/">load_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize/">parameterize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_extract_columns/">parameterize_extract_columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_frame/">parameterize_frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_sources/">parameterize_sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_subdag/">parameterized_subdag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/parameterize_values/">parameterize_values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/pipe/">pipe family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/resolve/">resolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/save_to/">save_to</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/subdag/">subdag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/schema/">schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/tag/">tag*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/decorators/with_columns/">with_columns</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/drivers/">Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#driver">Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#defaultgraphexecutor">DefaultGraphExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Driver/#taskbasedgraphexecutor">TaskBasedGraphExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/AsyncDriver/">AsyncDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/drivers/Custom/">Custom Driver</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/caching/">Caching</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Caching</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/caching-logic/">Caching logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/data-versioning/">Data versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/caching/stores/">Stores</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/graph-adapters/">GraphAdapters</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of GraphAdapters</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SimplePythonDataFrameGraphAdapter/">SimplePythonDataFrameGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SimplePythonGraphAdapter/">SimplePythonGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/HamiltonGraphAdapter/">HamiltonGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/AsyncGraphAdapter/">h_async.AsyncGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/ThreadPoolFutureAdapter/">h_threadpool.FutureAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/CachingGraphAdapter/">CachingGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/DaskGraphAdapter/">h_dask.DaskGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/PySparkUDFGraphAdapter/">h_spark.PySparkUDFGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/RayGraphAdapter/">h_ray.RayGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/RayWorkflowGraphAdapter/">h_ray.RayWorkflowGraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/graph-adapters/SparkKoalasGraphAdapter/">h_spark.SparkKoalasGraphAdapter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/lifecycle-hooks/">Lifecycle Adapters</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Lifecycle Adapters</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/ResultBuilder/">lifecycle.ResultBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/LegacyResultMixin/">lifecycle.LegacyResultMixin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphAdapter/">lifecycle.api.GraphAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NodeExecutionHook/">lifecycle.NodeExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphExecutionHook/">lifecycle.api.GraphExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/EdgeConnectionHook/">lifecycle.api.EdgeConnectionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NodeExecutionMethod/">lifecycle.api.NodeExecutionMethod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/StaticValidator/">lifecycle.api.StaticValidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GraphConstructionHook/">lifecycle.api.GraphConstructionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskSubmissionHook/">lifecycle.api.TaskSubmissionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskReturnHook/">lifecycle.api.TaskReturnHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskExecutionHook/">lifecycle.api.TaskExecutionHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/TaskGroupingHook/">lifecycle.api.TaskGroupingHook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/PDBDebugger/">lifecycle.PDBDebugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/PrintLn/">lifecycle.PrintLn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/ProgressBar/">plugins.h_tqdm.ProgressBar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/RichProgressBar/">plugins.h_rich.RichProgressBar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/DDOGTracer/">plugins.h_ddog.DDOGTracer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/FunctionInputOutputTypeChecker/">lifecycle.FunctionInputOutputTypeChecker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/SlackNotifierHook/">plugins.h_slack.SlackNotifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/GracefulErrorAdapter/">lifecycle.GracefulErrorAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/SparkInputValidator/">plugins.h_spark.SparkInputValidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/Narwhals/">plugins.h_narhwals.NarwhalsAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/Narwhals/#plugins-h-narhwals-narwhalsdataframeresultbuilder">plugins.h_narhwals.NarwhalsDataFrameResultBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/MLFlowTracker/">plugins.h_mlflow.MLFlowTracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/NoEdgeAndInputTypeChecking/">lifecycle.NoEdgeAndInputTypeChecking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle-hooks/OpenLineageAdapter/">plugins.h_openlineage.OpenLineageAdapter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/result-builders/">ResultBuilders</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of ResultBuilders</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Generic/">Generic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Numpy/">Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Pandas/">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Polars/">Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Dask/">Dask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/result-builders/Custom/">Custom ResultBuilder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/io/">I/O</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of I/O</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/">Using Data Adapters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/#data-loaders">Data Loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/available-data-adapters/#data-savers">Data Savers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/io/adapter-documentation/">Data Adapters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/dataflows/">Dataflows</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Dataflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/clear_storage/">clear_storage()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/copy/">copy()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/find/">find()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/import_module/">import_module()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/inspect/">inspect()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/inspect_module/">inspect_module()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/install_dependencies_string/">install_dependencies_string()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/latest_commit/">latest_commit()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/list/">list()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dataflows/pull_module/">pull_module()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/disabling-telemetry/">Telemetry</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXTERNAL RESOURCES</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/hamilton">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.tryhamilton.dev/">tryhamilton.dev</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hub.dagworks.io/docs/">Dataflow Hub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blog.dagworks.io/">Blog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/apache/hamilton/blob/main/docs/integrations/dlt/index.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/apache/hamilton/edit/main/docs/integrations/dlt/index.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="dlt">
<h1>dlt<a class="headerlink" href="#dlt" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://dlthub.com/">dlt</a> stands for “data load tool”. It’s an open-source Python library providing a ton of data <code class="docutils literal notranslate"><span class="pre">Sources</span></code> (Slack, Stripe, Google Analytics, Zendesk, etc.) and <code class="docutils literal notranslate"><span class="pre">Destinations</span></code> (S3, Snowflake, BigQuery, Postgres, etc.). <code class="docutils literal notranslate"><span class="pre">Pipelines</span></code> make it easy to connect <code class="docutils literal notranslate"><span class="pre">Sources</span></code> and <code class="docutils literal notranslate"><span class="pre">Destinations</span></code> and provide advanced engineering features such as table normalization, incremental loading, and automatic schema evolution.</p>
<p>dlt is an “extract and load” tool and Apache Hamilton is a “transform” tool, allowing various usage patterns.</p>
<p>On this page, you’ll learn:</p>
<ul class="simple">
<li><p>Extract, Transform, Load (ETL)</p></li>
<li><p>Extract, Load, Transform (ELT)</p></li>
<li><p>dlt materializer plugin for Apache Hamilton</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See this <a class="reference external" href="https://blog.dagworks.io/p/slack-summary-pipeline-with-dlt-ibis">blog post</a> for a more detailed discussion about ETL with dlt + Apache Hamilton</p>
</div>
<section id="extract-transform-load-etl">
<h2>Extract, Transform, Load (ETL)<a class="headerlink" href="#extract-transform-load-etl" title="Link to this heading">¶</a></h2>
<p>The key consideration for ETL is that the data has to move twice:</p>
<blockquote>
<div><p>ingest raw data (dlt) -&gt; transform (Apache Hamilton) -&gt; store transformed data (dlt)</p>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>Extract</strong>: dlt moves the raw data to a processing server</p></li>
<li><p><strong>Transform</strong>: on the server, Apache Hamilton executes transformations</p></li>
<li><p><strong>Load</strong>: dlt moves the final data to its destination (database, dashboard, etc.)</p></li>
</ol>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Reduce storage cost: raw data isn’t stored</p></li>
<li><p>Data centralization: transformed data is better separated from raw and low quality data</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>Increased latency: data has to move twice</p></li>
<li><p>Reduced flexibility: to try new transformations, data needs to</p></li>
</ul>
<section id="extract">
<h3>Extract<a class="headerlink" href="#extract" title="Link to this heading">¶</a></h3>
<ol class="arabic" start="0">
<li><p>Create a dlt pipeline for raw data ingestion (see <a class="reference external" href="https://dlthub.com/docs/walkthroughs/create-a-pipeline">dlt guide</a>).</p></li>
<li><p>Write the dlt pipeline execution code in <code class="docutils literal notranslate"><span class="pre">run.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>

<span class="c1"># define dlt pipeline to a local duckdb instance</span>
<span class="n">extract_pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack_raw&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="c1"># configure dlt slack source</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">slack_source</span><span class="p">(</span>
    <span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># moves data from source to destination</span>
<span class="n">raw_load_info</span> <span class="o">=</span> <span class="n">extract_pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="transform">
<h3>Transform<a class="headerlink" href="#transform" title="Link to this heading">¶</a></h3>
<ol class="arabic" start="2">
<li><p>Define the Apache Hamilton dataflow of transformations</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># transform.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_table_to_df</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data as DataFrame using the dlt SQL client&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">client</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">table_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">general_message</span><span class="p">(</span><span class="n">pipeline</span><span class="p">:</span> <span class="n">dlt</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load table `general_message` from dlt data&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">sql_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_table_to_df</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s2">&quot;general_message&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">general_replies_message</span><span class="p">(</span><span class="n">pipeline</span><span class="p">:</span> <span class="n">dlt</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load table `general_replies_message` from dlt data&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">sql_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_table_to_df</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s2">&quot;general_replies_message&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">threads</span><span class="p">(</span>
    <span class="n">general_message</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">general_replies_message</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reassemble from the union of parent messages and replies&quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;thread_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;ts&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span><span class="n">general_message</span><span class="p">[</span><span class="n">columns</span><span class="p">],</span> <span class="n">general_replies_message</span><span class="p">[</span><span class="n">columns</span><span class="p">]],</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p><img alt="" src="../../_images/transform.png" /></p>
<ol class="arabic" start="3">
<li><p>Add the Apache Hamilton dataflow execution code to <code class="docutils literal notranslate"><span class="pre">run.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>  <span class="c1"># module containing dataflow definition</span>

<span class="c1"># pass the `transform` module</span>
<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="c1"># request the node `threads`; pass the dlt `pipeline` as inputs</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span><span class="s2">&quot;threads&quot;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">extract_pipeline</span><span class="p">))</span>
<span class="c1"># `results` is a dictionary with key `threads`</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="load">
<h3>Load<a class="headerlink" href="#load" title="Link to this heading">¶</a></h3>
<ol class="arabic" start="4">
<li><p>Create a 2nd dlt pipeline to load the transformed data. The <code class="docutils literal notranslate"><span class="pre">pipeline_name</span></code> should be different from the <strong>Extract</strong> step.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="c1"># define dlt pipeline to bigquery (our prod env)</span>
<span class="n">load_pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack_final&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="c1"># pass the results from Apache Hamilton to dlt</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;threads&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="n">final_load_info</span> <span class="o">=</span> <span class="n">load_pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="etl-summary">
<h3>ETL Summary<a class="headerlink" href="#etl-summary" title="Link to this heading">¶</a></h3>
<p>You need to set up your dlt pipeline for raw and transformed data, and define your Apache Hamilton transformation dataflow. Then, your execution code consist of executing the ETL step in sequence. It should look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>  <span class="c1"># module containing dataflow definition</span>

<span class="c1"># EXTRACT</span>
<span class="n">extract_pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack_raw&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">slack_source</span><span class="p">(</span>
    <span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">raw_load_info</span> <span class="o">=</span> <span class="n">extract_pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

<span class="c1"># TRANSFORM</span>
<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span><span class="s2">&quot;threads&quot;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">extract_pipeline</span><span class="p">))</span>

<span class="c1"># LOAD</span>
<span class="n">load_pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack_final&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;threads&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="n">final_load_info</span> <span class="o">=</span> <span class="n">load_pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="extract-load-transform-elt">
<h2>Extract, Load, Transform (ELT)<a class="headerlink" href="#extract-load-transform-elt" title="Link to this heading">¶</a></h2>
<p>Compared to ETL, ELT moves data once.</p>
<blockquote>
<div><p>ingest and store raw data (dlt) -&gt; transform (Apache Hamilton)</p>
</div></blockquote>
<p>Transformations happen within the data destination, typically a data warehouse. To achieve this, we will leverage the <a class="reference external" href="https://ibis-project.org/">Ibis</a> library, which allows to execute data transformations directly on the destination backend.</p>
<ol class="arabic simple">
<li><p><strong>Extract &amp; Load</strong>: dlt moves the raw data to the destination</p></li>
<li><p><strong>Transform</strong>: Apache Hamilton + Ibis execute transformations within the destination</p></li>
</ol>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Deduplicate computation: redundant operations can be optimized using raw and intermediary data</p></li>
<li><p>Simpler architecture: no transformation server is needed, unlike ETL</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>Increased storage cost: more space is required to store raw and intermediary data</p></li>
<li><p>Decreased data quality: the sprawl of data of various quality levels needs to be governed</p></li>
</ul>
<section id="extract-load">
<h3>Extract &amp; Load<a class="headerlink" href="#extract-load" title="Link to this heading">¶</a></h3>
<ol class="arabic" start="0">
<li><p>Create a dlt pipeline for raw data ingestion (see <a class="reference external" href="https://dlthub.com/docs/walkthroughs/create-a-pipeline">dlt guide</a>).</p></li>
<li><p>Write the dlt pipeline execution code in <code class="docutils literal notranslate"><span class="pre">run.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>

<span class="c1"># define dlt pipeline to duckdb</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="c1"># load dlt slack source</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">slack_source</span><span class="p">(</span>
    <span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># execute dlt pipeline</span>
<span class="n">load_info</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>


</pre></div>
</div>
</li>
</ol>
</section>
<section id="id1">
<h3>Transform<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ol class="arabic" start="2">
<li><p>Define a dataflow of transformations using Apache Hamilton + Ibis</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># transform.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ibis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ibis.expr.types</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ir</span>

<span class="k">def</span><span class="w"> </span><span class="nf">db_con</span><span class="p">(</span><span class="n">pipeline</span><span class="p">:</span> <span class="n">dlt</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ibis</span><span class="o">.</span><span class="n">BaseBackend</span><span class="p">:</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline_name</span><span class="si">}</span><span class="s2">.duckdb&quot;</span><span class="p">)</span>
    <span class="n">ibis</span><span class="o">.</span><span class="n">set_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">backend</span>

<span class="k">def</span><span class="w"> </span><span class="nf">general_message</span><span class="p">(</span><span class="n">db_con</span><span class="p">:</span> <span class="n">ibis</span><span class="o">.</span><span class="n">BaseBackend</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">dlt</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load table `general_message` from dlt data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">db_con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
        <span class="s2">&quot;general_message&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">pipeline</span><span class="o">.</span><span class="n">dataset_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline_name</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span>
        <span class="n">thread_ts</span><span class="o">=</span><span class="n">ibis</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">thread_ts</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">ibis</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
    <span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">general_replies_message</span><span class="p">(</span><span class="n">db_con</span><span class="p">:</span> <span class="n">ibis</span><span class="o">.</span><span class="n">BaseBackend</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">dlt</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load table `general_replies_message` from dlt data&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">db_con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
        <span class="s2">&quot;general_replies_message&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">pipeline</span><span class="o">.</span><span class="n">dataset_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline_name</span>
    <span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">threads</span><span class="p">(</span>
    <span class="n">general_message</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
    <span class="n">general_replies_message</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the union of `general_message` and `general_replies_message`&quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;thread_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;ts&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ibis</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
        <span class="n">general_message</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span>
        <span class="n">general_replies_message</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span>
    <span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">insert_threads</span><span class="p">(</span><span class="n">threads</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">db_con</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span>  <span class="c1"># retrieves the backend set in `db_con()`</span>
    <span class="n">db_con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s2">&quot;threads&quot;</span><span class="p">,</span> <span class="n">threads</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</li>
<li><p>Execute the Apache Hamilton dataflow to trigger transformations on the backend</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="c1"># hamilton transform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>  <span class="c1"># module containing dataflow definition</span>

<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;insert_threads&quot;</span><span class="p">],</span>  <span class="c1"># execute node `insert_threads`</span>
    <span class="n">inputs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">)</span>  <span class="c1"># pass the dlt pipeline</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="elt-summary">
<h3>ELT Summary<a class="headerlink" href="#elt-summary" title="Link to this heading">¶</a></h3>
<p>You need to set up your dlt pipeline for raw, and define your Apache Hamilton transformation dataflow. Then, your execution code consist of using dlt to move data to the backend and Apache Hamilton + Ibis to execute transformations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>  <span class="c1"># module containing dataflow definition</span>

<span class="c1"># EXTRACT &amp; LOAD</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">slack_source</span><span class="p">(</span>
    <span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">load_info</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

<span class="c1"># TRANSFORM</span>
<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;insert_threads&quot;</span><span class="p">],</span>  <span class="c1"># query the `threads` node</span>
    <span class="n">inputs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">)</span>  <span class="c1"># pass the dlt load info</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="dlt-materializer-plugin">
<h2>dlt materializer plugin<a class="headerlink" href="#dlt-materializer-plugin" title="Link to this heading">¶</a></h2>
<p>We added custom Data Loader/Saver to plug dlt with Apache Hamilton. Compared to the previous approach, it allows to include the dlt operations as part of the Apache Hamilton dataflow and improve lineage / visibility.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference external" href="https://github.com/apache/hamilton/blob/main/examples/dlt/dlt_plugin.ipynb">this notebook</a> for a demo.</p>
</div>
<section id="dataloader">
<h3>DataLoader<a class="headerlink" href="#dataloader" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> allows to read in-memory data from a <code class="docutils literal notranslate"><span class="pre">dlt.Resource</span></code>. When working with <code class="docutils literal notranslate"><span class="pre">dlt.Source</span></code>, you can access individual <code class="docutils literal notranslate"><span class="pre">dlt.Resource</span></code> with <code class="docutils literal notranslate"><span class="pre">source.resource[&quot;source_name&quot;]</span></code>. This removes the need to write utility functions to read data from dlt (with pandas or Ibis). Contrary to the previous ETL and ELT examples, this approach is useful when you don’t want to store the dlt Source data. It effectively connects dlt to Apache Hamilton to enable “Extract, Transform” (ET).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.materialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="n">materializers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">from_</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;general_message&quot;</span><span class="p">,</span>  <span class="c1"># node name assigned to the data</span>
        <span class="n">resource</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="s2">&quot;general_message&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">from_</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;general_replies_message&quot;</span><span class="p">,</span>
        <span class="n">resource</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="s2">&quot;general_replies_message&quot;</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">]</span>
<span class="c1"># when using only loaders (i.e., `from_`), you need to specify</span>
<span class="c1"># `additional_vars` to compute, like you would in `.execute(final_vars=[&quot;threads&quot;])`</span>
<span class="n">dr</span><span class="o">.</span><span class="n">materialize</span><span class="p">(</span><span class="o">*</span><span class="n">materializers</span><span class="p">,</span> <span class="n">additional_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;threads&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="datasaver">
<h3>DataSaver<a class="headerlink" href="#datasaver" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">DataSaver</span></code> allows to write node results to any <code class="docutils literal notranslate"><span class="pre">dlt.Destination</span></code>. You’ll need to define a <code class="docutils literal notranslate"><span class="pre">dlt.Pipeline</span></code> with the desired <code class="docutils literal notranslate"><span class="pre">dlt.Destination</span></code> and you can specify arguments for the <code class="docutils literal notranslate"><span class="pre">pipeline.run()</span></code> behavior (e.g., incremental loading, primary key, load_file_format). This provides a “Transform, Load” (TL) connector from Apache Hamilton to dlt.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.materialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">to</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>

<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="n">materializers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">to</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;threads__dlt&quot;</span><span class="p">,</span>  <span class="c1"># node name</span>
        <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;threads&quot;</span><span class="p">],</span>
        <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;slack_threads&quot;</span><span class="p">,</span>
        <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">dr</span><span class="o">.</span><span class="n">materialize</span><span class="p">(</span><span class="o">*</span><span class="n">materializers</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="combining-both">
<h3>Combining both<a class="headerlink" href="#combining-both" title="Link to this heading">¶</a></h3>
<p>You can also combine both the <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> and <code class="docutils literal notranslate"><span class="pre">DataSaver</span></code>. You will see below that it’s almost identical to the ELT example, but now all operations are part of the Apache Hamilton dataflow!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dlt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton</span><span class="w"> </span><span class="kn">import</span> <span class="n">driver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hamilton.io.materialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_</span><span class="p">,</span> <span class="n">to</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">slack</span>  <span class="c1"># NOTE this is dlt code, not an official Slack library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">transform</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">dlt</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;slack&quot;</span><span class="p">,</span>
    <span class="n">destination</span><span class="o">=</span><span class="s1">&#39;duckdb&#39;</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;slack_community_backup&quot;</span>
<span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">slack</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">selected_channels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span> <span class="n">replies</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dr</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span><span class="o">.</span><span class="n">with_modules</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="n">materializers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">from_</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;general_message&quot;</span><span class="p">,</span>
        <span class="n">resource</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="s2">&quot;general_message&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">from_</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;general_replies_message&quot;</span><span class="p">,</span>
        <span class="n">resource</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="s2">&quot;general_replies_message&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">to</span><span class="o">.</span><span class="n">dlt</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;threads__dlt&quot;</span><span class="p">,</span>
        <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;threads&quot;</span><span class="p">],</span>
        <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;slack_threads&quot;</span><span class="p">,</span>
        <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">dr</span><span class="o">.</span><span class="n">materialize</span><span class="p">(</span><span class="o">*</span><span class="n">materializers</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../../_images/materialization1.png" /></p>
</section>
</section>
<section id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Our full <a class="reference external" href="https://github.com/apache/hamilton/tree/main/examples/dlt">code example to ingest Slack data and generate thread summaries</a> is available on GitHub.</p></li>
<li><p>Another important pattern in data engineering is reverse ETL, which consists of moving data analytics back to your sources (CRM, Hubspot, Zendesk, etc.). See this <a class="reference external" href="https://dlthub.com/docs/blog/reverse-etl-dlt">dlt blog</a> to get started.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fastapi/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">FastAPI</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Integrations</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">dlt</a><ul>
<li><a class="reference internal" href="#extract-transform-load-etl">Extract, Transform, Load (ETL)</a><ul>
<li><a class="reference internal" href="#extract">Extract</a></li>
<li><a class="reference internal" href="#transform">Transform</a></li>
<li><a class="reference internal" href="#load">Load</a></li>
<li><a class="reference internal" href="#etl-summary">ETL Summary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extract-load-transform-elt">Extract, Load, Transform (ELT)</a><ul>
<li><a class="reference internal" href="#extract-load">Extract &amp; Load</a></li>
<li><a class="reference internal" href="#id1">Transform</a></li>
<li><a class="reference internal" href="#elt-summary">ELT Summary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dlt-materializer-plugin">dlt materializer plugin</a><ul>
<li><a class="reference internal" href="#dataloader">DataLoader</a></li>
<li><a class="reference internal" href="#datasaver">DataSaver</a></li>
<li><a class="reference internal" href="#combining-both">Combining both</a></li>
</ul>
</li>
<li><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=22e4c79f"></script>
    </body>
</html>